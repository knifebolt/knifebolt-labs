<!DOCTYPE html>
<html>
<head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<style>

body {
	font-family: Arial;
	font-size: 12.5px;
}

:root {
    --colour1: #F4F4F4;
    --colour2: #BDBDBD;
    --size: 40px;
}
#icon-loader {
	zoom: 0.01;
}
#overlay {
    position: fixed;
    top: 0px;
    width: 100vw;
    height: 100vh;
    background-color: rgba(100,100,100,0.5);
    left: 0px;
}
#icon-editor {
    width: 60vw;
    margin: auto;
    background: white;
    border-radius: 3px;
    margin-top: 50px;
}
.checkerboard {
    width: 100%;
    height: 100%;
    background: conic-gradient(
        var(--colour1) 90deg,
        var(--colour2) 90deg 180deg,
        var(--colour1) 180deg 270deg,
        var(--colour2) 270deg
    );
    background-size: var(--size) var(--size);
}
#selected-icon {
	height: 300px;
	width: 300px;
}
span#close-editor {
    position: relative;
    float: right;
    margin-right: 15px;
    margin-top: 5px;
    font-size: 30px;
	cursor: pointer
}
#close-editor:hover {
	color: gray;
}
.editor-input-div{
    border: 2px solid #D3D3D3;
    margin: 20px;
    border-radius: 4px;
	height: 25px;
}
.editor-input-label {
    margin-left: 5px;
    position: relative;
    top: -8px;
    background: white;
    padding: 3px;
	color: #4F4F4F;
}
.editor-input {
    vertical-align: top;
    position: relative;
    margin-left: 5px;
    margin-top: -10px;
    border: none;
    outline: none;
}
#icons > svg {
    margin: 8px;
	cursor: pointer;
}
#icons > svg:hover {
    outline: 2px solid yellow;
}
#selected-icon > svg {
    height: 100% !important;
    width: 100% !important;
}

#selected-icon > svg path:hover {
    cursor: pointer;
}

#download-icon {
    margin-left: 20px;
    border: none;
    outline: none;
    background: #868686;
    color: white;
    padding: 8px;
    border-radius: 4px;
    cursor: pointer;
    width: 140px;
}
#download-icon:hover {
	background: #B2B2B2;
}

</style>
</head>
<body>

<div id="icon-loader"></div>
<div id="icons"></div>
<div id="overlay">
	<div id="icon-editor">
		<span id="close-editor">&#10006;</span>
		<table id="icon-editor-table">
			<tbody>
				<tr>
					<td>
						<div id="selected-icon" class="checkerboard">
						</div>
					</td>
					<td>
						<div id="editor-inputs">
							<div class="editor-input-div"><span class="editor-input-label">File Name</span><br><input class="editor-input" id="file-name" type="text"></input></div>
							<div class="editor-input-div"><span class="editor-input-label">Entire Color</span><br><input class="editor-input" id="entire-color" type="text"></input></div>
							<div class="editor-input-div"><span class="editor-input-label">Selected Path ID</span><br><input class="editor-input" id="selected-path-id" type="text"></input></div>
							<div class="editor-input-div"><span class="editor-input-label">Selected Path Color</span><br><input class="editor-input color-picker" id="selected-path-color" type="text"></input></div>
							<div class="editor-input-div"><span class="editor-input-label">File Type</span><br> 
								<select class="editor-input" id="file-type-select">
									<option value="svg">.svg</option>
									<option value="png">.png</option>
									<option value="png">.jpeg</option>
								</select>
							</div>
							<div><input id="download-icon" type="submit" value="Download Icon" /></div>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
		
	</div>
</div>
</div>

<script>

function LoadIcons() {

	var iconList = [
		"Arrow-Circle",
		"Shield-1",
		"Speed-Boot",
		"Sword-1"
	];

	var svgString = "";
	for (let i = 0; i < iconList.length; i++) {
		svgString += '<object data="SVG/'+ iconList[i] +'.svg" width="500px" height="500px"> </object>'
	}
	document.querySelectorAll("#icon-loader")[0].insertAdjacentHTML("beforeEnd",svgString);
	
	setTimeout(function(){
		
		
		var svgHtml = "";
		var svgObjects = document.querySelectorAll('#icon-loader > object');
		for (let i = 0; i < svgObjects.length; i++) {
			var name = svgObject[i].getAttribute("data").replace("SVG/","").replace(".svg","");
			svgHtml += svgObjects[i].contentDocument.childNodes[0].outerHTML.replace("<svg",'<svg style="height:70px;width:70px;" viewBox="0 0 500 500" icon-name="' + name +'"');
		}
		document.querySelectorAll("#icons")[0].insertAdjacentHTML("beforeEnd",svgHtml);
		document.querySelectorAll("#icon-loader")[0].remove();
		
	},1000);
	
}

LoadIcons();
$("#overlay").hide();
$("#close-editor").click(function(){
	$("#overlay").hide();
});

$("#icons").on("click","svg",function(){
	$("#selected-icon").empty();
	var selectedIcon = $(this).clone();
	var fileName = $(this).attr("icon-name");
	$("#file-name").val(fileName);
	$(selectedIcon).find("path").css("stroke-opacity",0);
	
	$("#selected-icon").append(selectedIcon);
	$("#overlay").show();		
	
	setTimeout(function(){
		$("#selected-icon path").addClass("color-picker");
	},200);
	
});

$("#selected-icon").on("click","svg path", function(){
	ColorPicker.StartingColor = $(this).css("fill");
	$("#selected-icon svg path").css("stroke-width",0);
	$(this).css("stroke","yellow").css("stroke-width",5);
	setTimeout(function(){$("#selected-path-color").click();},50);
	$("#selected-path-id").val($(this).attr("id"));
	
});

$("#selected-path-color").on("change",function(){
	var selectedPathID = $("#selected-path-id").val();
	$("#selected-icon #"+selectedPathID).css("fill",$("#selected-path-color").val()).css("stroke-width",0);
});

$("#download-icon").on("click",function(){
	var filename = $("#file-name").val() + ".svg";
	var fileContent = document.querySelectorAll("#selected-icon > svg")[0].outerHTML;
	var element = document.createElement('a');
	element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(fileContent));
	element.setAttribute('download', filename);

	element.style.display = 'none';
	document.body.appendChild(element);

	element.click();

	document.body.removeChild(element);
	
});

</script>
<script src="https://knifebolt.github.io/knifebolt-labs/ColorPicker/ColorPicker.js"></script>
<script>
ColorPicker.Options = { "Simplified" : true };
</script>
</body>
